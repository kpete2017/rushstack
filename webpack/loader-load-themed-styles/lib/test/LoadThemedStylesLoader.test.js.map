{"version":3,"file":"LoadThemedStylesLoader.test.js","sourceRoot":"","sources":["../../src/test/LoadThemedStylesLoader.test.ts"],"names":[],"mappings":"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","sourcesContent":["import webpack = require('webpack');\r\n// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport { LoadThemedStylesLoader } from './../LoadThemedStylesLoader';\r\nimport LoadThemedStylesMock = require('./testData/LoadThemedStylesMock');\r\n\r\nfunction wrapResult(loaderResult: string): string {\r\n  return `var module = { id: 'testId', exports: {} };\r\n  ${loaderResult}\r\n  module;`;\r\n}\r\n\r\ndescribe('LoadThemedStylesLoader', () => {\r\n  beforeEach(() => {\r\n    LoadThemedStylesLoader.resetLoadedThemedStylesPath();\r\n    LoadThemedStylesMock.loadedData = [];\r\n    LoadThemedStylesMock.calledWithAsync = [];\r\n  });\r\n\r\n  it('follows the Webpack loader interface', () => {\r\n    expect(LoadThemedStylesLoader).toBeDefined();\r\n    expect(LoadThemedStylesLoader.pitch).toBeDefined();\r\n\r\n    expect(() => new LoadThemedStylesLoader()).toThrow();\r\n  });\r\n\r\n  it('it correctly resolves load-themed-styles', () => {\r\n    const expectedPath: string = require.resolve('@microsoft/load-themed-styles');\r\n    expect(LoadThemedStylesLoader.loadedThemedStylesPath).toEqual(expectedPath);\r\n  });\r\n\r\n  it('it inserts the resolved load-themed-styles path', () => {\r\n    const expectedPath: string = require.resolve('@microsoft/load-themed-styles');\r\n    const loaderResult: string = LoadThemedStylesLoader.pitch.call({} as webpack.loader.LoaderContext, '');\r\n    expect(loaderResult.indexOf(expectedPath)).not.toBeNull();\r\n  });\r\n\r\n  it('it allows for override of load-themed-styles path', () => {\r\n    let expectedPath: string = './testData/LoadThemedStylesMock';\r\n    LoadThemedStylesLoader.loadedThemedStylesPath = expectedPath;\r\n    expect(LoadThemedStylesLoader.loadedThemedStylesPath).toEqual(expectedPath);\r\n\r\n    LoadThemedStylesLoader.resetLoadedThemedStylesPath();\r\n    expectedPath = require.resolve('@microsoft/load-themed-styles');\r\n    expect(LoadThemedStylesLoader.loadedThemedStylesPath).toEqual(expectedPath);\r\n  });\r\n\r\n  it('it inserts the overridden load-themed-styles path', () => {\r\n    const expectedPath: string = './testData/LoadThemedStylesMock';\r\n    const loaderResult: string = LoadThemedStylesLoader.pitch.call({} as webpack.loader.LoaderContext, '');\r\n    expect(loaderResult.indexOf(expectedPath)).not.toBeNull();\r\n  });\r\n\r\n  it('correctly calls loadStyles in load-themed-styles with a module reference', () => {\r\n    LoadThemedStylesLoader.loadedThemedStylesPath = './testData/LoadThemedStylesMock';\r\n\r\n    let loaderResult: string = LoadThemedStylesLoader.pitch.call(\r\n      {} as webpack.loader.LoaderContext,\r\n      './testData/MockStyle1'\r\n    );\r\n    loaderResult = loaderResult.replace(/require\\(\\\"!!/, 'require(\"');\r\n    loaderResult = wrapResult(loaderResult);\r\n\r\n    const returnedModule: { exports: string } = eval(loaderResult); // eslint-disable-line no-eval\r\n\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 1') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 2') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData).toHaveLength(2);\r\n    expect(LoadThemedStylesMock.calledWithAsync[0]).toEqual(false);\r\n    expect(LoadThemedStylesMock.calledWithAsync[1]).toEqual(false);\r\n    expect(LoadThemedStylesMock.calledWithAsync).toHaveLength(2);\r\n    expect(returnedModule.exports).toEqual('locals');\r\n  });\r\n\r\n  it('correctly calls loadStyles in load-themed-styles with a string reference', () => {\r\n    LoadThemedStylesLoader.loadedThemedStylesPath = './testData/LoadThemedStylesMock';\r\n\r\n    let loaderResult: string = LoadThemedStylesLoader.pitch.call(\r\n      {} as webpack.loader.LoaderContext,\r\n      './testData/MockStyle2'\r\n    );\r\n    loaderResult = loaderResult.replace(/require\\(\\\"!!/, 'require(\"');\r\n    loaderResult = wrapResult(loaderResult);\r\n\r\n    const returnedModule: { exports: string } = eval(loaderResult); // eslint-disable-line no-eval\r\n\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('styles') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData).toHaveLength(1);\r\n    expect(returnedModule.exports).toEqual({});\r\n  });\r\n\r\n  it('correctly handles the namedExport option', () => {\r\n    LoadThemedStylesLoader.loadedThemedStylesPath = './testData/LoadThemedStylesMock';\r\n\r\n    const query: {} = { namedExport: 'default' };\r\n    let loaderResult: string = LoadThemedStylesLoader.pitch.call(\r\n      { query } as webpack.loader.LoaderContext,\r\n      './testData/MockStyle1'\r\n    );\r\n    loaderResult = loaderResult.replace(/require\\(\\\"!!/, 'require(\"');\r\n    loaderResult = wrapResult(loaderResult);\r\n\r\n    const returnedModule: { exports: string } = eval(loaderResult); // eslint-disable-line no-eval\r\n\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 1') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 2') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData).toHaveLength(2);\r\n    expect(LoadThemedStylesMock.calledWithAsync[0]).toEqual(false);\r\n    expect(LoadThemedStylesMock.calledWithAsync[1]).toEqual(false);\r\n    expect(LoadThemedStylesMock.calledWithAsync).toHaveLength(2);\r\n    expect(returnedModule.exports).toEqual({ default: 'locals' });\r\n  });\r\n\r\n  it('correctly handles the async option set to \"true\"', () => {\r\n    LoadThemedStylesLoader.loadedThemedStylesPath = './testData/LoadThemedStylesMock';\r\n\r\n    const query: {} = { async: true };\r\n    let loaderResult: string = LoadThemedStylesLoader.pitch.call(\r\n      { query } as webpack.loader.LoaderContext,\r\n      './testData/MockStyle1'\r\n    );\r\n    loaderResult = loaderResult.replace(/require\\(\\\"!!/, 'require(\"');\r\n    loaderResult = wrapResult(loaderResult);\r\n\r\n    const returnedModule: { exports: string } = eval(loaderResult); // eslint-disable-line no-eval\r\n\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 1') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 2') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData).toHaveLength(2);\r\n    expect(LoadThemedStylesMock.calledWithAsync[0]).toEqual(true);\r\n    expect(LoadThemedStylesMock.calledWithAsync[1]).toEqual(true);\r\n    expect(LoadThemedStylesMock.calledWithAsync).toHaveLength(2);\r\n    expect(returnedModule.exports).toEqual('locals');\r\n  });\r\n\r\n  it('correctly handles the async option set to a non-boolean', () => {\r\n    LoadThemedStylesLoader.loadedThemedStylesPath = './testData/LoadThemedStylesMock';\r\n\r\n    let loaderResult: string = LoadThemedStylesLoader.pitch.call(\r\n      {} as webpack.loader.LoaderContext,\r\n      './testData/MockStyle1'\r\n    );\r\n    loaderResult = loaderResult.replace(/require\\(\\\"!!/, 'require(\"');\r\n    loaderResult = wrapResult(loaderResult);\r\n\r\n    const returnedModule: { exports: string } = eval(loaderResult); // eslint-disable-line no-eval\r\n\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 1') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData.indexOf('STYLE 2') !== -1).toEqual(true);\r\n    expect(LoadThemedStylesMock.loadedData).toHaveLength(2);\r\n    expect(LoadThemedStylesMock.calledWithAsync[0]).toEqual(false);\r\n    expect(LoadThemedStylesMock.calledWithAsync[1]).toEqual(false);\r\n    expect(LoadThemedStylesMock.calledWithAsync).toHaveLength(2);\r\n    expect(returnedModule.exports).toEqual('locals');\r\n  });\r\n});\r\n"]}